\documentclass[11pt,a4paper]{ivoa}
\input tthdefs

\usepackage{array}
\usepackage{tabulary}  % for nicer tables
\usepackage{calc}
\usepackage{placeins}
\setlength\extrarowheight{2pt}

\newcolumntype{L}{>{\centering\arraybackslash}m{3cm}}

\title{Model Instances in Votables}

% see ivoatexDoc for what group names to use here
\ivoagroup{DM}

\newcommand{\TODO}[1]{%
    \noindent%
    \colorbox{todocolor}{%
            \parbox{0.85\linewidth}{\sffamily \textbf{TODO:}\\
            #1}
    }%
    \vspace{2pt}
}

\newcommand{\note}[1]{%
    \noindent%
    \textcolor{darkgrey}{{\sffamily Note:} \emph{#1}}%
}

\newcommand{\comment}[1]{%
    \noindent%
    \textcolor{red}{{\sffamily Comment:} \emph{#1}}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% XML syntax coloration and formatting
%
\definecolor{todocolor}{rgb}{1,1,0.8}
\definecolor{darkred}{rgb}{0.6,0,0}
\definecolor{rose}{rgb}{1.0,0.88,0.88}
\definecolor{darkgrey}{rgb}{0.35,0.35,0.35}
\definecolor{gray}{rgb}{0.4,0.4,0.4}
\definecolor{darkblue}{rgb}{0.0,0.0,0.6}
\definecolor{maroon}{rgb}{0.5,0,0}
\definecolor{cyan}{rgb}{0.0,0.6,0.6}

\lstset{
  columns=fullflexible,
  showstringspaces=false,
  commentstyle=\color{gray}\upshape
}

\lstdefinelanguage{XML}
{
  morestring=[b]",
  morestring=[s]{>}{<},
  morecomment=[s]{<?}{?>}, 
  morecomment=[s]{<!--}{-->},
  stringstyle=\color{black},
  identifierstyle=\color{darkblue},
  keywordstyle=\color{maroon},
  morekeywords={ref,utype,dmrole, dmtype, value}% list your attributes here
}

\lstdefinestyle{XML}{
    captionpos=b,
    basicstyle=\small\ttfamily
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Document core
%
\author{Fran√ßois Bonnarel}
\author{Gilles Landais}
\author{Laurent Michel}
\author{Jesus Salgado}
\author{Gerard Lemson}

\editor{Laurent Michel}
\editor{Mark Cresitello Dittmar}


% \previousversion[????URL????]{????Concise Document Label????}
\previousversion{This is the first public release}
       

\begin{document}

\begin{abstract}
Vodml-instance-vot proposes a syntax to map VOTable data on any model serialized in VO-DML.
Vodml-instance-vot annotations are grouped in a single XML block located in the VOTable head. The annotation block allows to easily reconstruct the model structure. It designed in a way that the block can be reused on different data sets in order to facilitate the annotation process.
Vodml-instance-vot is enable to join data from different tables
\end{abstract}


\section*{Acknowledgments}
CDS/TDIG/SourceDM contributors

\section*{Conformance-related definitions}

The words ``MUST'', ``SHALL'', ``SHOULD'', ``MAY'', ``RECOMMENDED'', and
``OPTIONAL'' (in upper or lower case) used in this document are to be
interpreted as described in IETF standard RFC2119 \citep{std:RFC2119}.

The \emph{Virtual Observatory (VO)} is a
general term for a collection of federated resources that can be used
to conduct astronomical research, education, and outreach.
The \href{http://www.ivoa.net}{International
Virtual Observatory Alliance (IVOA)} is a global
collaboration of separately funded projects to develop standards and
infrastructure that enable VO applications.


\section{Introduction}



\lstset{language=XML}

\subsection{Role within the VO Architecture}

\begin{figure}
\centering

% As of ivoatex 1.2, the architecture diagram is generated by ivoatex in
% SVG; copy ivoatex/archdiag-full.xml to archdiag.xml and throw out
% all lines not relevant to your standard.
% Notes don't generally need this.  If you don't copy archdiag.xml,
% you must remove archdiag.svg from FIGURES in the Makefile.

\includegraphics[width=0.9\textwidth]{role_diagram.pdf}
\caption{Architecture diagram for this document}
\label{fig:archdiag}
\end{figure}

Fig.~\ref{fig:archdiag} shows the role this document plays within the
IVOA architecture \citep{note:VOARCH}.

???? and so on, LaTeX as you know and love it. ????

\section{Use Cases and Requirements}

\subsection{Use Cases}

\subsection{Requirements}


\section{Syntax}
\includegraphics[width=\textwidth]{merged-syntax-summary.png}

\subsection{Mapping Block Structure}

\begin{lstlisting}[caption={Complete mapping block example},style=XML,basicstyle=\tiny]
<VOTABLE xmlns="http://www.ivoa.net/xml/VOTable/v1.3" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            version="1.4">
   <VODML>
        <MODEL>   ...  </MODEL>
        <GLOBALS>   ...  </GLOBALS>
        <TEMPLATES>   ...  </TEMPLATES>
       . ..
    </VODML>
    ...
</VOTABLE>
\end{lstlisting}


\subsection{Syntax}

\subsubsection{MODEL}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
            @name  & 
            Name of the mapped model (informal).  This attribute must be left empty  \\
       \hline 
            @url & 
            Url of the vo-dml serialization of the model. \\
       \hline 
     \end{tabulary}
     \caption{\texttt{MODEL} attributes} 
     \label{tbl:model-att}
 \end{table}

\FloatBarrier

\subsubsection{GLOBALS}

\FloatBarrier

\subsubsection{TEMPLATES}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
            @tableref & 
            ID of the mapped table  \\
        \hline 
     \end{tabulary}
     \caption{\texttt{TEMPLATES} attributes} 
     \label{tbl:templates-att}
 \end{table}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}
    \hline 
        \textbf{@tableref} &
        \textbf{Pattern}\\
    \hline      \hline  
        OPT &           
        Always mandatory\\
   \hline 
\end{tabulary}
     \caption{Valid attribute patterns for  \texttt{TEMPLATES}} 
     \label{tbl:templates-pattern}
 \end{table}
 
\FloatBarrier

\subsubsection{COLLECTION}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
            @ID & 
            ID of the mapping element  \\
        \hline 
            @dmrole & 
            Role of the collection in the DM \\
        \hline 
     \end{tabulary}
     \caption{\texttt{COLLECTION} attributes} 
     \label{tbl:collection-att}
 \end{table}
 
\FloatBarrier

\subsubsection{INSTANCE}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
            @ID & 
            ID of the mapping element  \\
        \hline 
            @dmrole & 
            Role of the instance in the DM \\
        \hline 
     \end{tabulary}
     \caption{\texttt{INSTANCE} attributes} 
     \label{tbl:instance-att}
 \end{table}


\FloatBarrier

\subsubsection{ATTRIBUTE}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
            @dmrole & 
            Role of the attribute \\
        \hline 
            @dmtype & 
            Type of the attribute \\
        \hline 
            @ref & 
            --- \\
        \hline 
            @value& 
            --- \\
        \hline 
            @unit & 
            --- \\
        \hline 
            @arrayindex& 
            --- \\
        \hline 
     \end{tabulary}
     \caption{\texttt{ATTRIBUTE} attributes} 
     \label{tbl:attribute-att}
 \end{table}



\FloatBarrier

\subsubsection{REFERENCE}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
            @dmrole & 
            Role of the referenced instance in the DM \\
        \hline 
            @tableref& 
            ---- \\
        \hline 
            @dmref & 
            ---- \\
        \hline 
     \end{tabulary}
     \caption{\texttt{REFERENCE} attributes} 
     \label{tbl:reference-att}
 \end{table}


\FloatBarrier

\subsubsection{JOIN}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
             @tableref& 
            ---- \\
        \hline 
            @dmref & 
            ---- \\
        \hline 
     \end{tabulary}
     \caption{\texttt{JOIN} attributes} 
     \label{tbl:join-att}
 \end{table}



\FloatBarrier

\subsubsection{WHERE}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
             @primarykey& 
            ---- \\
        \hline 
            @foreignkey & 
            ---- \\
        \hline 
            @value & 
            ---- \\
        \hline 
     \end{tabulary}
     \caption{\texttt{WHERE} attributes} 
     \label{tbl:where-att}
 \end{table}


\FloatBarrier

\subsubsection{PRIMARY\_KEY}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
             @ref& 
            ---- \\
        \hline 
            @dmtype & 
            ---- \\
        \hline 
            @value & 
            ---- \\
        \hline 
     \end{tabulary}
     \caption{\texttt{PRIMARY\_KEY} attributes} 
     \label{tbl:primarykey-att}
 \end{table}


\FloatBarrier

\subsubsection{FOREIGN\_KEY}

\begin{table}[!htbp]
\small
\centering
\begin{tabulary}{\linewidth}{|c|J|}       
       \hline 
            \textbf{Attribute} & 
            \textbf {Role}\\
       \hline         \hline  
             @ref& 
            ---- \\
     \end{tabulary}
     \caption{\texttt{FOREIGN\_KEY} attributes} 
     \label{tbl:foreignkey-att}
 \end{table}

\FloatBarrier




\section{Changes from Previous Versions}

No previous versions yet.  
% these would be subsections "Changes from v. WD-..."
% Use itemize environments.


% NOTE: IVOA recommendations must be cited from docrepo rather than ivoabib
% (REC entries there are for legacy documents only)
\bibliography{ivoatex/ivoabib,ivoatex/docrepo,merged-syntax}


\end{document}
