\documentclass[11pt,a4paper]{ivoa}
\input tthdefs

\usepackage{array}
\usepackage{tabulary}  % for nicer tables
\usepackage{calc}
\usepackage{placeins}
\setlength\extrarowheight{2pt}

\newcolumntype{L}{>{\centering\arraybackslash}m{3cm}}

\title{Model Instances in Votables}

% see ivoatexDoc for what group names to use here
\ivoagroup{DM}

\newcommand{\TODO}[1]{%
    \noindent%
    \colorbox{todocolor}{%
            \parbox{0.85\linewidth}{\sffamily \textbf{TODO:}\\
            #1}
    }%
    \vspace{2pt}
}

\newcommand{\note}[1]{%
    \noindent%
    \textcolor{darkgrey}{{\sffamily Note:} \emph{#1}}%
}

\newcommand{\comment}[1]{%
    \noindent%
    \textcolor{red}{{\sffamily Comment:} \emph{#1}}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% XML syntax coloration and formatting
%
\definecolor{todocolor}{rgb}{1,1,0.8}
\definecolor{darkred}{rgb}{0.6,0,0}
\definecolor{rose}{rgb}{1.0,0.88,0.88}
\definecolor{darkgrey}{rgb}{0.35,0.35,0.35}
\definecolor{gray}{rgb}{0.4,0.4,0.4}
\definecolor{darkblue}{rgb}{0.0,0.0,0.6}
\definecolor{maroon}{rgb}{0.5,0,0}
\definecolor{cyan}{rgb}{0.0,0.6,0.6}

\lstset{
  columns=fullflexible,
  showstringspaces=false,
  commentstyle=\color{gray}\upshape
}

\lstdefinelanguage{XML}
{
  morestring=[b]",
  morestring=[s]{>}{<},
  morecomment=[s]{<?}{?>}, 
  morecomment=[s]{<!--}{-->},
  stringstyle=\color{black},
  identifierstyle=\color{darkblue},
  keywordstyle=\color{maroon},
  morekeywords={ref,utype,dmrole, dmtype, value}% list your attributes here
}

\lstdefinestyle{XML}{
    captionpos=b,
    basicstyle=\small\ttfamily
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Document core
%
\author{Fran√ßois Bonnarel}
\author{Gilles Landais}
\author{Laurent Michel}
\author{Jesus Salgado}
\author{Gerard Lemson}

\editor{Laurent Michel}
\editor{Mark Cresitello Dittmar}


% \previousversion[????URL????]{????Concise Document Label????}
\previousversion{This is the first public release}
       

\begin{document}

\begin{abstract}
Vodml-instance-vot proposes a syntax to map VOTable data on any model serialized in VO-DML.
Vodml-instance-vot annotations are grouped in a single XML block located in the VOTable head. The annotation block allows to easily reconstruct the model structure. It designed in a way that the block can be reused on different data sets in order to facilitate the annotation process.
Vodml-instance-vot is enable to join data from different tables
\end{abstract}


\section*{Acknowledgments}
CDS/TDIG/SourceDM contributors

\section*{Conformance-related definitions}

The words ``MUST'', ``SHALL'', ``SHOULD'', ``MAY'', ``RECOMMENDED'', and
``OPTIONAL'' (in upper or lower case) used in this document are to be
interpreted as described in IETF standard RFC2119 \citep{std:RFC2119}.

The \emph{Virtual Observatory (VO)} is a
general term for a collection of federated resources that can be used
to conduct astronomical research, education, and outreach.
The \href{http://www.ivoa.net}{International
Virtual Observatory Alliance (IVOA)} is a global
collaboration of separately funded projects to develop standards and
infrastructure that enable VO applications.

\pagebreak
\section{Introduction}
\input{introduction}

\subsection{Role within the VO Architecture}

\begin{figure}[h]
\centering

% As of ivoatex 1.2, the architecture diagram is generated by ivoatex in
% SVG; copy ivoatex/archdiag-full.xml to archdiag.xml and throw out
% all lines not relevant to your standard.
% Notes don't generally need this.  If you don't copy archdiag.xml,
% you must remove archdiag.svg from FIGURES in the Makefile.

\includegraphics[width=0.9\textwidth]{role_diagram.pdf}
\caption{Architecture diagram for this document}
\label{fig:archdiag}
\end{figure}

Fig.~\ref{fig:archdiag} shows the role this document plays within
the IVOA architecture \citep{2010ivoa.rept.1123A}.


\pagebreak
\section{Use Cases and Requirements}

\subsection{Use Cases}
\input{use_cases}

\subsection{Requirements}
\input{requirements}

% use XML formatting for listings
\lstset{language=XML}

\pagebreak
\section{Relation to VOTable}

The data model annotation will reside within the scope of a VOTABLE.
\textit{ Describe which version(s) of VOTable should this be expected to work with? V1.3+ } \newline

\noindent \textbf{Location}

The mapping block:
\begin{itemize}
\item MUST be contained in a VOTable RESOURCE with \texttt{type="meta"}.
\item which MUST be the first child of a RESOURCE with \texttt{type="results"}.
\item there MUST be no more than one mapping block per 'results' RESOURCE.
\end{itemize}

The scope of the mapping block is the whole content of the 'results' RESOURCE. \newline

\noindent \textbf{Namespace}

The \texttt{dm-mapping} name space isolates VOTable elements from mapping elements, and MUST be defined on the mapping block. \newline

\begin{lstlisting}[frame=single,caption={Mapping block in a VOTable},style=XML,basicstyle=\tiny]
<VOTABLE xmlns="http://www.ivoa.net/xml/VOTable/v1.3" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.3">
  <RESOURCE type="results">
    <RESOURCE type="meta">
      <dm-mapping:VODML xmlns:dm-mapping="http://www.ivoa.net/xml/merged-syntax">
        ...
      </dm-mapping:VODML>
    </RESOURCE>
    <TABLE name="myDataTable">
      ....
    </TABLE>
  </RESOURCE>
</VOTABLE>
\end{lstlisting}


\pagebreak
\section{Syntax}

  \begin{figure}[h]
    \begin{center}
      \includegraphics[width=\textwidth]{merged-syntax-summary.png}
      \caption{Annotation Syntax Summary}
      \label{fig:summary}
    \end{center}
  \end{figure}

\pagebreak
\subsection{VODML}
\input{element_vodml.tex}
\FloatBarrier
 
\subsection{MODEL}
\input{element_model.tex}
\FloatBarrier

\subsection{GLOBALS}
\input{element_globals.tex}
\FloatBarrier

\subsection{TEMPLATES}
\input{element_templates.tex}
\FloatBarrier

\subsection{COLLECTION}
\input{element_collection.tex}
\FloatBarrier

\subsection{INSTANCE}
\input{element_instance.tex}
\FloatBarrier

\subsection{ATTRIBUTE}
\input{element_attribute.tex}
\FloatBarrier

\subsection{REFERENCE}
\input{element_reference.tex}
\FloatBarrier

\subsection{JOIN}
\input{element_join.tex}
\FloatBarrier

\subsection{WHERE}
\input{element_where.tex}
\FloatBarrier

\subsection{PRIMARY\_KEY}
\input{element_primary_key.tex}
\FloatBarrier

\subsection{FOREIGN\_KEY}
\input{element_foreign_key.tex}
\FloatBarrier

\pagebreak
\section{Changes from Previous Versions}

No previous versions yet.  
% these would be subsections "Changes from v. WD-..."
% Use itemize environments.


% NOTE: IVOA recommendations must be cited from docrepo rather than ivoabib
% (REC entries there are for legacy documents only)
\bibliography{ivoatex/ivoabib,ivoatex/docrepo,merged-syntax}


\end{document}
